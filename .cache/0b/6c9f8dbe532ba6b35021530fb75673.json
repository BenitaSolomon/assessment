{"id":"../smoke-node/streams/writable.ts","dependencies":[{"name":"C:\\Users\\Administrator\\Desktop\\smoke\\smoke-node\\tsconfig.json","includedInParent":true,"mtime":1582445133494},{"name":"C:\\Users\\Administrator\\Desktop\\smoke\\package.json","includedInParent":true,"mtime":1582444621053},{"name":"../async/index","loc":{"line":30,"column":24},"parent":"C:\\Users\\Administrator\\Desktop\\smoke\\smoke-node\\streams\\writable.ts","resolved":"C:\\Users\\Administrator\\Desktop\\smoke\\smoke-node\\async\\index.ts"}],"generated":{"js":"\"use strict\";\n/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2020 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst index_1 = require(\"../async/index\");\n/**\r\n * Provides an asynchronous Writable abstraction over streams. This type is\r\n * used as a sender for Readable<T> and also provides hooks for the\r\n * WritableStream<T> type that is currently pending implementation in\r\n * Firefox.\r\n */\n\n\nclass Writable {\n  constructor(sink) {\n    this.sink = sink;\n    this.controller = {};\n    this.semaphore = new index_1.Semaphore(1);\n    this.start();\n  }\n  /** Starts this writable. */\n\n\n  async start() {\n    if (this.sink.start) {\n      try {\n        await this.semaphore.run(() => this.sink.start(this.controller));\n      } catch (error) {\n        this.error = error;\n        throw error;\n      }\n    }\n  }\n  /** Writes this value to the stream. */\n\n\n  async write(data) {\n    if (this.error !== undefined) {\n      throw this.error;\n    }\n\n    if (this.sink.write) {\n      try {\n        await this.semaphore.run(() => this.sink.write(data, this.controller));\n      } catch (error) {\n        this.error = error;\n        throw error;\n      }\n    }\n  }\n  /** Aborts this stream with an error.. */\n\n\n  async abort(error = new Error('abort')) {\n    if (this.error !== undefined) {\n      throw this.error;\n    }\n\n    if (this.sink.abort) {\n      try {\n        await this.semaphore.run(() => this.sink.abort(error));\n      } catch (error) {\n        this.error = error;\n        throw error;\n      }\n    }\n  }\n  /** Closes this stream. */\n\n\n  async close() {\n    if (this.error !== undefined) {\n      throw this.error;\n    }\n\n    if (this.sink.close) {\n      try {\n        await this.semaphore.run(() => this.sink.close());\n      } catch (error) {\n        this.error = error;\n        throw error;\n      }\n    }\n  }\n\n}\n\nexports.Writable = Writable;"},"sourceMaps":{"js":{"mappings":[{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":1,"column":0},"generated":{"line":2,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":29,"column":0},"generated":{"line":34,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":29,"column":0},"generated":{"line":34,"column":6}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":29,"column":0},"generated":{"line":34,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":29,"column":0},"generated":{"line":34,"column":16}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":29,"column":0},"generated":{"line":34,"column":23}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":29,"column":0},"generated":{"line":34,"column":24}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":29,"column":0},"generated":{"line":34,"column":40}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":29,"column":0},"generated":{"line":34,"column":41}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":31,"column":0},"generated":{"line":35,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":37,"column":0},"generated":{"line":43,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":37,"column":13},"generated":{"line":43,"column":6}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":37,"column":0},"generated":{"line":43,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":37,"column":21},"generated":{"line":43,"column":15}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":41,"column":2},"generated":{"line":44,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":41,"column":2},"generated":{"line":44,"column":2}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":41,"column":2},"generated":{"line":44,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":41,"column":31},"generated":{"line":44,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":41,"column":2},"generated":{"line":44,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":41,"column":54},"generated":{"line":44,"column":20}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":41,"column":31},"generated":{"line":45,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":41,"column":31},"generated":{"line":45,"column":9}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":41,"column":31},"generated":{"line":45,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":41,"column":31},"generated":{"line":45,"column":16}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":41,"column":31},"generated":{"line":45,"column":20}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":42,"column":4},"generated":{"line":46,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":42,"column":9},"generated":{"line":46,"column":9}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":42,"column":4},"generated":{"line":46,"column":19}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":42,"column":22},"generated":{"line":46,"column":22}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":42,"column":4},"generated":{"line":46,"column":24}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":43,"column":4},"generated":{"line":47,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":43,"column":9},"generated":{"line":47,"column":9}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":43,"column":4},"generated":{"line":47,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":43,"column":21},"generated":{"line":47,"column":21}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":43,"column":25},"generated":{"line":47,"column":25}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":43,"column":25},"generated":{"line":47,"column":32}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":43,"column":25},"generated":{"line":47,"column":33}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":43,"column":21},"generated":{"line":47,"column":42}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":43,"column":35},"generated":{"line":47,"column":43}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":43,"column":21},"generated":{"line":47,"column":44}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":43,"column":4},"generated":{"line":47,"column":45}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":44,"column":4},"generated":{"line":48,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":44,"column":9},"generated":{"line":48,"column":9}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":44,"column":4},"generated":{"line":48,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":45,"column":3},"generated":{"line":49,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":47,"column":2},"generated":{"line":50,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":48,"column":10},"generated":{"line":53,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":48,"column":16},"generated":{"line":53,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":48,"column":10},"generated":{"line":53,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":48,"column":21},"generated":{"line":53,"column":16}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":49,"column":4},"generated":{"line":54,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":49,"column":7},"generated":{"line":54,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":49,"column":12},"generated":{"line":54,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":49,"column":7},"generated":{"line":54,"column":17}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":49,"column":17},"generated":{"line":54,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":49,"column":4},"generated":{"line":54,"column":23}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":49,"column":24},"generated":{"line":54,"column":25}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":50,"column":6},"generated":{"line":55,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":50,"column":10},"generated":{"line":55,"column":10}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":8},"generated":{"line":56,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":14},"generated":{"line":56,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":19},"generated":{"line":56,"column":19}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":14},"generated":{"line":56,"column":28}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":29},"generated":{"line":56,"column":29}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":14},"generated":{"line":56,"column":32}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":33},"generated":{"line":56,"column":33}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":39},"generated":{"line":56,"column":39}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":44},"generated":{"line":56,"column":44}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":39},"generated":{"line":56,"column":48}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":49},"generated":{"line":56,"column":49}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":39},"generated":{"line":56,"column":54}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":56},"generated":{"line":56,"column":55}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":61},"generated":{"line":56,"column":60}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":39},"generated":{"line":56,"column":70}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":14},"generated":{"line":56,"column":71}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":51,"column":8},"generated":{"line":56,"column":72}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":52,"column":7},"generated":{"line":57,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":50,"column":6},"generated":{"line":57,"column":7}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":52,"column":8},"generated":{"line":57,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":52,"column":15},"generated":{"line":57,"column":15}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":52,"column":8},"generated":{"line":57,"column":20}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":52,"column":22},"generated":{"line":57,"column":22}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":53,"column":8},"generated":{"line":58,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":53,"column":13},"generated":{"line":58,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":53,"column":8},"generated":{"line":58,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":53,"column":21},"generated":{"line":58,"column":21}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":53,"column":8},"generated":{"line":58,"column":26}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":54,"column":8},"generated":{"line":59,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":54,"column":14},"generated":{"line":59,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":54,"column":8},"generated":{"line":59,"column":19}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":55,"column":7},"generated":{"line":60,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":56,"column":5},"generated":{"line":61,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":57,"column":3},"generated":{"line":62,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":59,"column":2},"generated":{"line":63,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":60,"column":9},"generated":{"line":66,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":60,"column":15},"generated":{"line":66,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":60,"column":9},"generated":{"line":66,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":60,"column":21},"generated":{"line":66,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":60,"column":9},"generated":{"line":66,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":60,"column":28},"generated":{"line":66,"column":20}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":61,"column":4},"generated":{"line":67,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":61,"column":7},"generated":{"line":67,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":61,"column":12},"generated":{"line":67,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":61,"column":7},"generated":{"line":67,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":61,"column":22},"generated":{"line":67,"column":23}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":61,"column":4},"generated":{"line":67,"column":32}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":61,"column":33},"generated":{"line":67,"column":34}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":62,"column":6},"generated":{"line":68,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":62,"column":12},"generated":{"line":68,"column":12}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":62,"column":17},"generated":{"line":68,"column":17}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":62,"column":6},"generated":{"line":68,"column":22}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":63,"column":5},"generated":{"line":69,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":64,"column":4},"generated":{"line":71,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":64,"column":7},"generated":{"line":71,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":64,"column":12},"generated":{"line":71,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":64,"column":7},"generated":{"line":71,"column":17}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":64,"column":17},"generated":{"line":71,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":64,"column":4},"generated":{"line":71,"column":23}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":64,"column":24},"generated":{"line":71,"column":25}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":65,"column":6},"generated":{"line":72,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":65,"column":10},"generated":{"line":72,"column":10}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":8},"generated":{"line":73,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":14},"generated":{"line":73,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":19},"generated":{"line":73,"column":19}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":14},"generated":{"line":73,"column":28}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":29},"generated":{"line":73,"column":29}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":14},"generated":{"line":73,"column":32}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":33},"generated":{"line":73,"column":33}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":39},"generated":{"line":73,"column":39}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":44},"generated":{"line":73,"column":44}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":39},"generated":{"line":73,"column":48}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":49},"generated":{"line":73,"column":49}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":39},"generated":{"line":73,"column":54}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":56},"generated":{"line":73,"column":55}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":39},"generated":{"line":73,"column":59}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":62},"generated":{"line":73,"column":61}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":67},"generated":{"line":73,"column":66}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":39},"generated":{"line":73,"column":76}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":14},"generated":{"line":73,"column":77}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":66,"column":8},"generated":{"line":73,"column":78}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":67,"column":7},"generated":{"line":74,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":65,"column":6},"generated":{"line":74,"column":7}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":67,"column":8},"generated":{"line":74,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":67,"column":14},"generated":{"line":74,"column":15}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":67,"column":8},"generated":{"line":74,"column":20}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":67,"column":21},"generated":{"line":74,"column":22}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":68,"column":8},"generated":{"line":75,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":68,"column":13},"generated":{"line":75,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":68,"column":8},"generated":{"line":75,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":68,"column":21},"generated":{"line":75,"column":21}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":68,"column":8},"generated":{"line":75,"column":26}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":69,"column":8},"generated":{"line":76,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":69,"column":14},"generated":{"line":76,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":69,"column":8},"generated":{"line":76,"column":19}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":70,"column":7},"generated":{"line":77,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":71,"column":5},"generated":{"line":78,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":72,"column":3},"generated":{"line":79,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":74,"column":2},"generated":{"line":80,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":9},"generated":{"line":83,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":15},"generated":{"line":83,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":9},"generated":{"line":83,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":21},"generated":{"line":83,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":21},"generated":{"line":83,"column":19}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":36},"generated":{"line":83,"column":22}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":40},"generated":{"line":83,"column":26}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":36},"generated":{"line":83,"column":31}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":46},"generated":{"line":83,"column":32}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":36},"generated":{"line":83,"column":39}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":9},"generated":{"line":83,"column":40}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":75,"column":54},"generated":{"line":83,"column":42}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":76,"column":4},"generated":{"line":84,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":76,"column":7},"generated":{"line":84,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":76,"column":12},"generated":{"line":84,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":76,"column":7},"generated":{"line":84,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":76,"column":22},"generated":{"line":84,"column":23}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":76,"column":4},"generated":{"line":84,"column":32}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":76,"column":33},"generated":{"line":84,"column":34}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":77,"column":6},"generated":{"line":85,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":77,"column":12},"generated":{"line":85,"column":12}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":77,"column":17},"generated":{"line":85,"column":17}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":77,"column":6},"generated":{"line":85,"column":22}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":78,"column":5},"generated":{"line":86,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":79,"column":4},"generated":{"line":88,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":79,"column":7},"generated":{"line":88,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":79,"column":12},"generated":{"line":88,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":79,"column":7},"generated":{"line":88,"column":17}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":79,"column":17},"generated":{"line":88,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":79,"column":4},"generated":{"line":88,"column":23}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":79,"column":24},"generated":{"line":88,"column":25}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":80,"column":6},"generated":{"line":89,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":80,"column":10},"generated":{"line":89,"column":10}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":8},"generated":{"line":90,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":14},"generated":{"line":90,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":19},"generated":{"line":90,"column":19}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":14},"generated":{"line":90,"column":28}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":29},"generated":{"line":90,"column":29}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":14},"generated":{"line":90,"column":32}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":33},"generated":{"line":90,"column":33}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":39},"generated":{"line":90,"column":39}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":44},"generated":{"line":90,"column":44}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":39},"generated":{"line":90,"column":48}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":49},"generated":{"line":90,"column":49}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":39},"generated":{"line":90,"column":54}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":56},"generated":{"line":90,"column":55}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":39},"generated":{"line":90,"column":60}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":14},"generated":{"line":90,"column":61}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":81,"column":8},"generated":{"line":90,"column":62}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":82,"column":7},"generated":{"line":91,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":80,"column":6},"generated":{"line":91,"column":7}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":82,"column":8},"generated":{"line":91,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":82,"column":14},"generated":{"line":91,"column":15}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":82,"column":8},"generated":{"line":91,"column":20}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":82,"column":21},"generated":{"line":91,"column":22}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":83,"column":8},"generated":{"line":92,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":83,"column":13},"generated":{"line":92,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":83,"column":8},"generated":{"line":92,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":83,"column":21},"generated":{"line":92,"column":21}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":83,"column":8},"generated":{"line":92,"column":26}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":84,"column":8},"generated":{"line":93,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":84,"column":14},"generated":{"line":93,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":84,"column":8},"generated":{"line":93,"column":19}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":85,"column":7},"generated":{"line":94,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":86,"column":5},"generated":{"line":95,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":87,"column":3},"generated":{"line":96,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":89,"column":2},"generated":{"line":97,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":90,"column":9},"generated":{"line":100,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":90,"column":15},"generated":{"line":100,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":90,"column":9},"generated":{"line":100,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":90,"column":20},"generated":{"line":100,"column":16}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":91,"column":4},"generated":{"line":101,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":91,"column":7},"generated":{"line":101,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":91,"column":12},"generated":{"line":101,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":91,"column":7},"generated":{"line":101,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":91,"column":22},"generated":{"line":101,"column":23}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":91,"column":4},"generated":{"line":101,"column":32}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":91,"column":33},"generated":{"line":101,"column":34}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":92,"column":6},"generated":{"line":102,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":92,"column":12},"generated":{"line":102,"column":12}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":92,"column":17},"generated":{"line":102,"column":17}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":92,"column":6},"generated":{"line":102,"column":22}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":93,"column":5},"generated":{"line":103,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":94,"column":4},"generated":{"line":105,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":94,"column":7},"generated":{"line":105,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":94,"column":12},"generated":{"line":105,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":94,"column":7},"generated":{"line":105,"column":17}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":94,"column":17},"generated":{"line":105,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":94,"column":4},"generated":{"line":105,"column":23}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":94,"column":24},"generated":{"line":105,"column":25}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":95,"column":6},"generated":{"line":106,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":95,"column":10},"generated":{"line":106,"column":10}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":8},"generated":{"line":107,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":14},"generated":{"line":107,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":19},"generated":{"line":107,"column":19}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":14},"generated":{"line":107,"column":28}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":29},"generated":{"line":107,"column":29}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":14},"generated":{"line":107,"column":32}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":33},"generated":{"line":107,"column":33}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":39},"generated":{"line":107,"column":39}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":44},"generated":{"line":107,"column":44}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":39},"generated":{"line":107,"column":48}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":49},"generated":{"line":107,"column":49}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":39},"generated":{"line":107,"column":54}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":14},"generated":{"line":107,"column":56}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":96,"column":8},"generated":{"line":107,"column":57}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":97,"column":7},"generated":{"line":108,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":95,"column":6},"generated":{"line":108,"column":7}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":97,"column":8},"generated":{"line":108,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":97,"column":14},"generated":{"line":108,"column":15}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":97,"column":8},"generated":{"line":108,"column":20}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":97,"column":21},"generated":{"line":108,"column":22}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":98,"column":8},"generated":{"line":109,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":98,"column":13},"generated":{"line":109,"column":13}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":98,"column":8},"generated":{"line":109,"column":18}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":98,"column":21},"generated":{"line":109,"column":21}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":98,"column":8},"generated":{"line":109,"column":26}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":99,"column":8},"generated":{"line":110,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":99,"column":14},"generated":{"line":110,"column":14}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":99,"column":8},"generated":{"line":110,"column":19}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":100,"column":7},"generated":{"line":111,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":101,"column":5},"generated":{"line":112,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":102,"column":3},"generated":{"line":113,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":37,"column":21},"generated":{"line":115,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":37,"column":0},"generated":{"line":117,"column":0}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":37,"column":0},"generated":{"line":117,"column":7}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":37,"column":0},"generated":{"line":117,"column":8}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":37,"column":0},"generated":{"line":117,"column":16}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":37,"column":0},"generated":{"line":117,"column":19}},{"source":"../smoke-node/streams/writable.ts","name":null,"original":{"line":37,"column":0},"generated":{"line":117,"column":27}}],"sources":{"../smoke-node/streams/writable.ts":"/*--------------------------------------------------------------------------\r\n\r\nsmoke-node\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2020 Haydn Paterson (sinclair) <haydn.developer@gmail.com>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n\r\n---------------------------------------------------------------------------*/\r\n\r\nimport { Semaphore } from '../async/index'\r\n\r\n/**\r\n * Provides an asynchronous Writable abstraction over streams. This type is\r\n * used as a sender for Readable<T> and also provides hooks for the\r\n * WritableStream<T> type that is currently pending implementation in\r\n * Firefox.\r\n */\r\nexport class Writable<T = any> {\r\n  private semaphore:  Semaphore\r\n  private controller: WritableStreamDefaultController\r\n  private error: Error | undefined\r\n  constructor(private readonly sink: UnderlyingSink<T>) {\r\n    this.controller = {} as any as WritableStreamDefaultController\r\n    this.semaphore = new Semaphore(1)\r\n    this.start()\r\n  }\r\n\r\n  /** Starts this writable. */\r\n  private async start(): Promise<void> {\r\n    if(this.sink.start) {\r\n      try {\r\n        await this.semaphore.run(() => this.sink.start!(this.controller))\r\n      } catch (error) {\r\n        this.error = error\r\n        throw error\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Writes this value to the stream. */\r\n  public async write(data: T): Promise<void> {\r\n    if(this.error !== undefined) {\r\n      throw this.error\r\n    }\r\n    if(this.sink.write) {\r\n      try {\r\n        await this.semaphore.run(() => this.sink.write!(data, this.controller))\r\n      } catch(error) {\r\n        this.error = error\r\n        throw error\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Aborts this stream with an error.. */\r\n  public async abort(error: Error = new Error('abort')): Promise<void> {\r\n    if(this.error !== undefined) {\r\n      throw this.error\r\n    }\r\n    if(this.sink.abort) {\r\n      try {\r\n        await this.semaphore.run(() => this.sink.abort!(error))\r\n      } catch(error) {\r\n        this.error = error\r\n        throw error\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Closes this stream. */\r\n  public async close(): Promise<void> {\r\n    if(this.error !== undefined) {\r\n      throw this.error\r\n    }\r\n    if(this.sink.close) {\r\n      try {\r\n        await this.semaphore.run(() => this.sink.close!())\r\n      } catch(error) {\r\n        this.error = error\r\n        throw error\r\n      }\r\n    }\r\n  }\r\n}"},"lineCount":null}},"error":null,"hash":"b7e14b93f75f34adca271f722bd7e851","cacheData":{"env":{}}}